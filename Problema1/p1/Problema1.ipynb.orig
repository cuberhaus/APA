{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "392e97cd",
   "metadata": {},
   "outputs": [],
   "source": [
    "import jax.numpy as jnp\n",
    "from jax import grad, vmap, jit, random, lax\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "3521846e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from numpy.random import seed\n",
    "from numpy.random import normal\n",
    "import matplotlib.pyplot as plt\n",
    "import scipy.stats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6eaeeede",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.91970116\n",
      "2.0279765\n",
      "3.0028834\n",
      "1.8900409\n",
      "0.9861963\n",
      "0.50449497\n"
     ]
    }
   ],
   "source": [
    "#generate data (3 gausiana n1 = 50, n2 = 500 y n3 = 5000)\n",
    "\n",
    "seed(56) \n",
    "# always the same seed to get the same results\n",
    "\n",
    "data1 = normal(loc=1, scale=2, size=50) # loc = media, scale = varianza\n",
    "data2 = normal(loc=2, scale=1, size=500)\n",
    "data3 = normal(loc=3, scale=0.5, size=5000)\n",
    "\n",
    "#find mean of sample\n",
    "media1 = jnp.mean(data1)\n",
    "media2 = jnp.mean(data2)\n",
    "media3 = jnp.mean(data3)\n",
    "print (media1)\n",
    "print (media2)\n",
    "print (media3)\n",
    "\n",
    "#find standard deviation of sample\n",
    "var1 = jnp.std(data1, ddof=1)\n",
    "var2 = jnp.std(data2, ddof=1)\n",
    "var3 = jnp.std(data3, ddof=1)\n",
    "print (var1)\n",
    "print (var2)\n",
    "print (var3)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "0af07633",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#grafico muestra3\n",
    "hx, hy, _ = plt.hist(data3, bins=50, color=\"lightblue\")\n",
    "\n",
    "plt.ylim(0.0,max(hx)+0.05)\n",
    "plt.title(r'Normal distribution $\\mu_0 = 3$ and $\\sigma_0 = 0.5$')\n",
    "plt.grid()\n",
    "\n",
    "#plt.savefig(\"likelihood_normal_distribution_01.png\", bbox_inches='tight')\n",
    "#plt.show()\n",
    "#plt.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "53c13a2d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-7745.292\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#log likuhood (copiado)\n",
    "scipy.stats.norm.pdf(6,2.0,1.0)\n",
    "\n",
    "print( jnp.log(scipy.stats.norm.pdf(data3,2.0,1.0)).sum() )\n",
    "\n",
    "x = jnp.linspace(-10, 10, 1000, endpoint=True)\n",
    "\n",
    "y = []\n",
    "for i in x:\n",
    "    y.append(jnp.log(scipy.stats.norm.pdf(data3,i,0.5)).sum())\n",
    "\n",
    "plt.plot(x,y)\n",
    "\n",
    "plt.title(r'Log-Likelihood')\n",
    "plt.xlabel(r'$\\mu$')\n",
    "\n",
    "plt.grid()\n",
    "\n",
    "#plt.savefig(\"likelihood_normal_distribution_02.png\", bbox_inches='tight')\n",
    "#plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "facb48f1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "mean --->  3.0028834\n",
      "std deviation --->  0.50444454\n"
     ]
    }
   ],
   "source": [
    "#mean using jnp\n",
    "print('mean ---> ', jnp.mean(data3))\n",
    "print('std deviation ---> ', jnp.std(data3))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "e54ebf3b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "mean (from max log likelohood) --->  2.9929926\n"
     ]
    }
   ],
   "source": [
    "#Mean estimated from the maximum of the log-likelihood\n",
    "\n",
    "y_min = y.index(max(y))\n",
    "print('mean (from max log likelohood) ---> ', x[y_min])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5a6dc2e0",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "726431f0",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (1475833692.py, line 5)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;36m  File \u001b[0;32m\"/tmp/ipykernel_33573/1475833692.py\"\u001b[0;36m, line \u001b[0;32m5\u001b[0m\n\u001b[0;31m    def llnorm\u001b[0m\n\u001b[0m              ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import math\n",
    "import scipy.optimize as optimize\n",
    "\n",
    "def llnorm\n",
    "\n",
    "data = 10 * np.random.randn(100) + 150\n",
    "\n",
    "result = optimize.minimize(llnorm, [150,10], args = (data))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4a0b99f2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "32960740",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "def myfunction(par, data):\n",
    "    n = len(data)\n",
    "    mu, sigma = par\n",
    "    ll = -jnp.sum(-n/2 * math.log(2*math.pi*(sigma**2)) - ((data-mu)**2)/(2 * (sigma**2)))\n",
    "    return ll\n",
    "\n",
    "\n",
    "def lossMAE(p,x,y):\n",
    "    n = jnp.abs(myfunction(p,x) - y)\n",
    "    print (n)\n",
    "    return n\n",
    "\n",
    "\n",
    "def lossMSE(p,x,y):\n",
    "    n = (myfunction(p,x) - y)**2\n",
    "    print (n)\n",
    "    return n\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "67551f46",
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "len() of unsized object",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mIndexError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m~/.local/lib/python3.10/site-packages/jax/core.py\u001b[0m in \u001b[0;36m_len\u001b[0;34m(self, ignored_tracer)\u001b[0m\n\u001b[1;32m   1362\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1363\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1364\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mIndexError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mIndexError\u001b[0m: tuple index out of range",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m/tmp/ipykernel_33573/2934356150.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mkey\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mrandom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mPRNGKey\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mx\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mjnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlinspace\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvmap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmyfunction\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0min_axes\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0.7\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      6\u001b[0m \u001b[0my\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata3\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mrandom\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnormal\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m50\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0;36m0.3\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mscatter\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mjnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlinspace\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "    \u001b[0;31m[... skipping hidden 3 frame]\u001b[0m\n",
      "\u001b[0;32m/tmp/ipykernel_33573/964216238.py\u001b[0m in \u001b[0;36mmyfunction\u001b[0;34m(par, data)\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mdef\u001b[0m \u001b[0mmyfunction\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpar\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m     \u001b[0mn\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m     \u001b[0mmu\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msigma\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpar\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m     \u001b[0mll\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m-\u001b[0m\u001b[0mjnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msum\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0mn\u001b[0m\u001b[0;34m/\u001b[0m\u001b[0;36m2\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mmath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlog\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0mmath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpi\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msigma\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0mmu\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m/\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m2\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0msigma\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mll\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "    \u001b[0;31m[... skipping hidden 1 frame]\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.10/site-packages/jax/core.py\u001b[0m in \u001b[0;36m_len\u001b[0;34m(self, ignored_tracer)\u001b[0m\n\u001b[1;32m   1363\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1364\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mIndexError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0merr\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1365\u001b[0;31m       \u001b[0;32mraise\u001b[0m \u001b[0mTypeError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"len() of unsized object\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0merr\u001b[0m  \u001b[0;31m# same as numpy error\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1366\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1367\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mTypeError\u001b[0m: len() of unsized object"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 720x720 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "fig = plt.figure(figsize=(10,10))\n",
    "key = random.PRNGKey(0)\n",
    "x = jnp.linspace(-2,2)\n",
    "data = vmap(myfunction, in_axes=(None,0))(jnp.array([1,0.7]), x)\n",
    "y = data3 + (random.normal(key,(50,)) *0.3)\n",
    "plt.scatter(jnp.linspace(-2,2),y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "79dda404",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "vmap was requested to map its argument along axis 0, which implies that its rank should be at least 1, but is only 0 (its shape is ())",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mIndexError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m~/.local/lib/python3.10/site-packages/jax/_src/api.py\u001b[0m in \u001b[0;36m_get_axis_size\u001b[0;34m(name, shape, axis)\u001b[0m\n\u001b[1;32m   1665\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1666\u001b[0;31m       \u001b[0;32mreturn\u001b[0m \u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1667\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mIndexError\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mTypeError\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mIndexError\u001b[0m: tuple index out of range",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m/tmp/ipykernel_33573/1592219800.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mparamMSE\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mjnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0.5\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mgrad_MSE\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mjit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgrad\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlossMSE\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mploss\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvmap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlossMSE\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0min_axes\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mparamMSE\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmean\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      6\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrange\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1000\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m     \u001b[0mpart\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvmap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgrad_MSE\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0min_axes\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mparamMSE\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "    \u001b[0;31m[... skipping hidden 6 frame]\u001b[0m\n",
      "\u001b[0;32m~/.local/lib/python3.10/site-packages/jax/_src/api.py\u001b[0m in \u001b[0;36m_get_axis_size\u001b[0;34m(name, shape, axis)\u001b[0m\n\u001b[1;32m   1667\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mIndexError\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mTypeError\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1668\u001b[0m       \u001b[0mmin_rank\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;36m1\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[0;34m>=\u001b[0m \u001b[0;36m0\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0;34m-\u001b[0m\u001b[0maxis\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1669\u001b[0;31m       raise ValueError(\n\u001b[0m\u001b[1;32m   1670\u001b[0m           \u001b[0;34mf\"{name} was requested to map its argument along axis {axis}, \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1671\u001b[0m           \u001b[0;34mf\"which implies that its rank should be at least {min_rank}, \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: vmap was requested to map its argument along axis 0, which implies that its rank should be at least 1, but is only 0 (its shape is ())"
     ]
    }
   ],
   "source": [
    "epsilon = 1e-9\n",
    "lr = 0.01\n",
    "paramMSE=jnp.array([0.5,1])\n",
    "grad_MSE = jit(grad(lossMSE))\n",
    "ploss = vmap(lossMSE,in_axes=(None,0,0))(paramMSE,x,y).mean(0)\n",
    "for i in range(1000):\n",
    "    part = vmap(grad_MSE,in_axes=(None,0,0))(paramMSE,x,y)\n",
    "    paramMSE -= (lr * part.mean(0))\n",
    "    loss = vmap(lossMSE,in_axes=(None,0,0))(paramMSE,x,y).mean(0)\n",
    "    if jnp.abs(ploss - loss) < epsilon:\n",
    "        print(i)\n",
    "        break\n",
    "    ploss = loss\n",
    "print(paramMSE, loss)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0135739d",
   "metadata": {},
   "outputs": [],
   "source": [
    "epsilon = 1e-9\n",
    "lr = 0.01\n",
    "paramMAE=jnp.array([0.5,1])\n",
    "ploss = vmap(lossMAE,in_axes=(None,0,0))(paramMAE,x,y).mean(0)\n",
    "for i in range(1000):\n",
    "    part = vmap(grad(lossMAE),in_axes=(None,0,0))(paramMAE,x,y)\n",
    "    paramMAE -= (lr * part.mean(0))\n",
    "    loss = vmap(lossMAE,in_axes=(None,0,0))(paramMAE,x,y).mean(0)\n",
    "    if jnp.abs(ploss -loss) < epsilon:\n",
    "        print(i)\n",
    "        break\n",
    "    ploss = loss\n",
    "print(paramMAE, loss)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "da8897a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig = plt.figure(figsize=(10,10))\n",
    "xlim = jnp.linspace(-2,2,100)\n",
    "dataMSE = vmap(myfunction, in_axes=(None,0))(paramMSE, xlim)\n",
    "dataMAE = vmap(myfunction, in_axes=(None,0))(paramMAE, xlim)\n",
    "real = vmap(myfunction, in_axes=(None,0))(jnp.array([1,0.7]), xlim)\n",
    "plt.plot(xlim,dataMSE, 'r')\n",
    "plt.plot(xlim,dataMAE, 'g')\n",
    "plt.plot(xlim,real, 'b')\n",
    "plt.scatter(jnp.linspace(-2,2),y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2e1e7f75",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
